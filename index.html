<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mandarin Battle: The Steal Update</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        .shake { animation: shake 0.2s ease-in-out 0s 2; }
        
        .vs-anim { animation: zoomIn 0.3s ease-out; }
        @keyframes zoomIn {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .thinking { animation: pulse 1s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .gradient-bg {
            background: linear-gradient(135deg, #020617 0%, #1e1b4b 100%);
        }

        .quiz-card {
            animation: slideUp 0.4s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen flex items-center justify-center p-4 text-white">

    <div id="game-card" class="bg-slate-900/90 w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden border border-white/10 backdrop-blur-xl">
        <!-- Header / Score -->
        <div class="p-6 bg-black/40 flex justify-between items-center border-b border-white/5">
            <div class="text-center">
                <p class="text-[10px] uppercase tracking-[0.2em] text-cyan-500 font-bold mb-1">Player</p>
                <p id="p-score" class="text-5xl font-black text-white drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]">0</p>
            </div>
            <div class="flex flex-col items-center">
                <span id="p-streak" class="bg-cyan-500/20 text-cyan-400 px-3 py-1 rounded-full text-[9px] font-black mb-2 border border-cyan-500/30">BEST OF 5</span>
                <div class="text-slate-700 font-black italic text-2xl">VS</div>
            </div>
            <div class="text-center">
                <p class="text-[10px] uppercase tracking-[0.2em] text-rose-500 font-bold mb-1">Bot</p>
                <p id="c-score" class="text-5xl font-black text-white drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]">0</p>
            </div>
        </div>

        <div class="p-8">
            <!-- Battle Arena -->
            <div id="battle-arena" class="text-center">
                <div id="status-msg" class="text-sm font-bold mb-8 text-slate-400 h-16 flex items-center justify-center px-4 leading-tight uppercase tracking-widest">
                    Choose your move to engage!
                </div>

                <!-- Hand Display -->
                <div class="flex justify-around items-center mb-10 bg-black/40 p-6 rounded-[2rem] border border-white/5">
                    <div class="flex flex-col items-center">
                        <div id="p-display" class="text-6xl mb-2">‚ùì</div>
                        <span class="text-[9px] text-slate-500 font-black tracking-widest">YOU</span>
                    </div>
                    <div class="w-px h-12 bg-white/10"></div>
                    <div class="flex flex-col items-center">
                        <div id="c-display" class="text-6xl mb-2">‚ùì</div>
                        <span class="text-[9px] text-slate-500 font-black tracking-widest">BOT</span>
                    </div>
                </div>

                <!-- RPS Buttons -->
                <div id="rps-controls" class="grid grid-cols-3 gap-4">
                    <button onclick="playRound('Batu', '‚úä')" class="group bg-slate-800/50 hover:bg-cyan-600 p-5 rounded-3xl transition-all transform hover:-translate-y-2 active:scale-95 border border-white/5">
                        <span class="text-4xl group-hover:scale-110 transition-transform block">‚úä</span>
                        <span class="text-[9px] font-black uppercase mt-2 block opacity-40">Rock</span>
                    </button>
                    <button onclick="playRound('Gunting', '‚úåÔ∏è')" class="group bg-slate-800/50 hover:bg-cyan-600 p-5 rounded-3xl transition-all transform hover:-translate-y-2 active:scale-95 border border-white/5">
                        <span class="text-4xl group-hover:scale-110 transition-transform block">‚úåÔ∏è</span>
                        <span class="text-[9px] font-black uppercase mt-2 block opacity-40">Scissor</span>
                    </button>
                    <button onclick="playRound('Kertas', 'üñêÔ∏è')" class="group bg-slate-800/50 hover:bg-cyan-600 p-5 rounded-3xl transition-all transform hover:-translate-y-2 active:scale-95 border border-white/5">
                        <span class="text-4xl group-hover:scale-110 transition-transform block">üñêÔ∏è</span>
                        <span class="text-[9px] font-black uppercase mt-2 block opacity-40">Paper</span>
                    </button>
                </div>
            </div>

            <!-- Quiz Arena -->
            <div id="quiz-arena" class="hidden text-center quiz-card">
                <div class="mb-6">
                    <span id="turn-badge" class="text-[10px] font-black px-6 py-1.5 rounded-full tracking-[0.2em] border">PLAYER'S TURN</span>
                </div>
                <p class="text-slate-500 text-[10px] font-bold uppercase tracking-widest mb-2">Translate this word</p>
                <h2 id="target-word" class="text-6xl font-black mb-8 text-white tracking-tighter">Â≠¶Ê†°</h2>
                <div id="options" class="space-y-3"></div>
            </div>

            <!-- Bot Thinking Arena -->
            <div id="bot-thinking-arena" class="hidden text-center quiz-card">
                <div class="mb-6">
                    <span class="bg-rose-500/20 text-rose-400 text-[10px] font-black px-6 py-1.5 rounded-full tracking-[0.2em] border border-rose-500/30">BOT IS THINKING</span>
                </div>
                <div class="flex flex-col items-center justify-center py-10">
                    <div class="text-7xl mb-6 thinking">üß†</div>
                    <p class="text-xs font-black text-rose-400 uppercase tracking-[0.3em]">Processing Logic...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Final Results Overlay -->
    <div id="overlay" class="fixed inset-0 bg-slate-950/98 hidden z-50 flex-col items-center justify-center p-6 text-center backdrop-blur-2xl">
        <div id="final-icon" class="text-8xl mb-8">üèÜ</div>
        <h1 id="final-msg" class="text-7xl font-black mb-4 tracking-tighter uppercase italic">VICTORY</h1>
        <p id="final-sub" class="text-slate-500 mb-12 text-lg font-medium tracking-wide">The arena is yours, Master.</p>
        <button onclick="location.reload()" class="bg-white text-black px-16 py-5 rounded-2xl font-black text-xl hover:bg-cyan-400 transition-all shadow-2xl">REMATCH</button>
    </div>

    <script>
        const wordBank = [
            { cn: "Â≠¶Ê†°", ms: "School" }, { cn: "ÂÖ¨Âõ≠", ms: "Park" },
            { cn: "ÁêÉÂú∫", ms: "Court/Field" }, { cn: "ËΩ¶Á´ô", ms: "Station" },
            { cn: "ÂØπÈù¢", ms: "Opposite" }, { cn: "ÊóÅËæπ", ms: "Beside" },
            { cn: "ÂâçÈù¢", ms: "In front" }, { cn: "ÂêéÈù¢", ms: "Behind" }
        ];

        let pScore = 0;
        let cScore = 0;
        const limit = 5;
        let currentTarget = null;
        let isStealAttempt = false;

        const pDisplay = document.getElementById('p-display');
        const cDisplay = document.getElementById('c-display');
        const statusMsg = document.getElementById('status-msg');
        const rpsControls = document.getElementById('rps-controls');
        const quizArena = document.getElementById('quiz-arena');
        const battleArena = document.getElementById('battle-arena');
        const botArena = document.getElementById('bot-thinking-arena');
        const turnBadge = document.getElementById('turn-badge');

        function playRound(name, emoji) {
            const choices = [
                { name: 'Batu', emoji: '‚úä' },
                { name: 'Gunting', emoji: '‚úåÔ∏è' },
                { name: 'Kertas', emoji: 'üñêÔ∏è' }
            ];
            
            const bot = choices[Math.floor(Math.random() * 3)];
            pDisplay.innerText = emoji;
            cDisplay.innerText = bot.emoji;
            [pDisplay, cDisplay].forEach(el => el.classList.add('vs-anim'));
            setTimeout(() => [pDisplay, cDisplay].forEach(el => el.classList.remove('vs-anim')), 300);

            if (name === bot.name) {
                statusMsg.innerText = "DRAW! CLASH AGAIN!";
                statusMsg.style.color = "#94a3b8";
            } else if (
                (name === 'Batu' && bot.name === 'Gunting') ||
                (name === 'Kertas' && bot.name === 'Batu') ||
                (name === 'Gunting' && bot.name === 'Kertas')
            ) {
                statusMsg.innerText = "PLAYER WON CLASH!";
                statusMsg.style.color = "#22d3ee";
                isStealAttempt = false;
                setTimeout(() => showQuiz('player'), 800);
            } else {
                statusMsg.innerText = "BOT WON CLASH!";
                statusMsg.style.color = "#f43f5e";
                isStealAttempt = false;
                setTimeout(() => showQuiz('bot'), 800);
            }
        }

        function showQuiz(turn) {
            battleArena.classList.add('hidden');
            botArena.classList.add('hidden');
            
            if (turn === 'player') {
                quizArena.classList.remove('hidden');
                turnBadge.innerText = isStealAttempt ? "REBOUND OPPORTUNITY!" : "PLAYER'S TURN";
                turnBadge.className = isStealAttempt ? 
                    "bg-orange-500/20 text-orange-400 text-[10px] font-black px-6 py-1.5 rounded-full tracking-[0.2em] border border-orange-500/30" : 
                    "bg-cyan-500/20 text-cyan-400 text-[10px] font-black px-6 py-1.5 rounded-full tracking-[0.2em] border border-cyan-500/30";
                
                if (!isStealAttempt) {
                    currentTarget = wordBank[Math.floor(Math.random() * wordBank.length)];
                }
                document.getElementById('target-word').innerText = currentTarget.cn;
                
                let opts = [currentTarget.ms];
                while(opts.length < 3) {
                    let r = wordBank[Math.floor(Math.random() * wordBank.length)].ms;
                    if(!opts.includes(r)) opts.push(r);
                }
                opts.sort(() => Math.random() - 0.5);

                const container = document.getElementById('options');
                container.innerHTML = '';
                opts.forEach(o => {
                    const b = document.createElement('button');
                    b.className = "w-full bg-slate-800 hover:bg-white hover:text-black py-4 rounded-2xl font-black transition-all text-xs uppercase tracking-widest border border-white/5";
                    b.innerText = o;
                    b.onclick = () => {
                        if(o === currentTarget.ms) {
                            pScore++;
                            quizArena.classList.add('hidden');
                            battleArena.classList.remove('hidden');
                            statusMsg.innerText = isStealAttempt ? "GREAT STEAL! +1 Point" : "COREECT! +1 Point";
                            statusMsg.style.color = "#4ade80";
                            resetDuel();
                            updateScore();
                        } else {
                            if (!isStealAttempt) {
                                isStealAttempt = true;
                                statusMsg.innerText = "WRONG! BOT STEAL ATTEMPT!";
                                statusMsg.style.color = "#f43f5e";
                                quizArena.classList.add('hidden');
                                setTimeout(() => showQuiz('bot'), 800);
                            } else {
                                quizArena.classList.add('hidden');
                                battleArena.classList.remove('hidden');
                                statusMsg.innerText = "BOTH FAILED! NO POINT.";
                                statusMsg.style.color = "#94a3b8";
                                resetDuel();
                                updateScore();
                            }
                        }
                    };
                    container.appendChild(b);
                });
            } else {
                botArena.classList.remove('hidden');
                if (!isStealAttempt) {
                    currentTarget = wordBank[Math.floor(Math.random() * wordBank.length)];
                }

                setTimeout(() => {
                    const botIsCorrect = Math.random() < 0.65; // Bot 65% accuracy
                    botArena.classList.add('hidden');
                    
                    if (botIsCorrect) {
                        cScore++;
                        battleArena.classList.remove('hidden');
                        statusMsg.innerText = isStealAttempt ? "BOT STOLE THE POINT!" : "BOT CORRECT! +1 Point";
                        statusMsg.style.color = "#f43f5e";
                        document.getElementById('game-card').classList.add('shake');
                        setTimeout(() => document.getElementById('game-card').classList.remove('shake'), 400);
                        resetDuel();
                        updateScore();
                    } else {
                        if (!isStealAttempt) {
                            isStealAttempt = true;
                            statusMsg.innerText = "BOT FAILED! YOUR TURN TO STEAL!";
                            statusMsg.style.color = "#fbbf24";
                            setTimeout(() => showQuiz('player'), 1000);
                        } else {
                            battleArena.classList.remove('hidden');
                            statusMsg.innerText = "BOTH FAILED! NO POINT.";
                            statusMsg.style.color = "#94a3b8";
                            resetDuel();
                            updateScore();
                        }
                    }
                }, 1800);
            }
        }

        function resetDuel() {
            pDisplay.innerText = '‚ùì';
            cDisplay.innerText = '‚ùì';
        }

        function updateScore() {
            document.getElementById('p-score').innerText = pScore;
            document.getElementById('c-score').innerText = cScore;
            
            if(pScore >= limit || cScore >= limit) {
                const overlay = document.getElementById('overlay');
                const msg = document.getElementById('final-msg');
                const icon = document.getElementById('final-icon');
                overlay.style.display = 'flex';
                if(pScore >= limit) {
                    msg.innerText = "VICTORY";
                    msg.className = "text-7xl font-black mb-4 text-cyan-400 tracking-tighter italic";
                    icon.innerText = "üèÜ";
                } else {
                    msg.innerText = "DEFEAT";
                    msg.className = "text-7xl font-black mb-4 text-rose-600 tracking-tighter italic";
                    icon.innerText = "üíÄ";
                }
            }
        }
    </script>
</body>
</html>

